#!/bin/sh
echo "$$" > "$2"
"$1/bin/armagetronad-dedicated" --vardir "$1/var" --userdatadir "$1/user" --configdir "$1/config" --datadir "$1/data" --input "$1/var/input.txt" -d
while [ $? -ne 0 ]; do
	sleep 3
	echo "WARNING: The server did not gracefully quit; now restarting."
	"$1/bin/armagetronad-dedicated" --vardir "$1/var" --userdatadir "$1/user" --configdir "$1/config" --datadir "$1/data" --input "$1/var/input.txt" -d
done
rm "$2"
